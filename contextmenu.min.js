function ContextMenu(g,c){function k(b){var n=document.createElement("ul");b.forEach(function(a){var f=document.createElement("li");""!=ContextUtil.getProperty(a,"liclass","")&&f.classList.add(ContextUtil.getProperty(a,"liclass",""));f.menu=d;if("undefined"===typeof a.type){var h=document.createElement("span");h.className="cm_icon_span";""!=ContextUtil.getProperty(a,"icon","")?h.innerHTML=ContextUtil.getProperty(a,"icon",""):h.innerHTML=ContextUtil.getProperty(c,"default_icon","");var e=document.createElement("span");
e.className="cm_text";""!=ContextUtil.getProperty(a,"text","")?e.innerHTML=ContextUtil.getProperty(a,"text",""):e.innerHTML=ContextUtil.getProperty(c,"default_text","item");var p=document.createElement("span");p.className="cm_sub_span";"undefined"!==typeof a.sub&&(""!=ContextUtil.getProperty(c,"sub_icon","")?p.innerHTML=ContextUtil.getProperty(c,"sub_icon",""):p.innerHTML="&#155;");f.appendChild(h);f.appendChild(e);f.appendChild(p);if(ContextUtil.getProperty(a,"enabled",!0)){if("object"===typeof a.events)for(h=
Object.keys(a.events),e=0;e<h.length;e++)f.addEventListener(h[e],a.events[h[e]]);"undefined"!==typeof a.sub&&f.appendChild(k(a.sub))}else f.setAttribute("disabled","")}else a.type==ContextMenu.DIVIDER&&(f.className="cm_divider");n.appendChild(f)});return n}function l(){d.hide()}var d=this,m=ContextMenu.count++;this.menu=g;this.contextTarget=null;if(!(g instanceof Array))throw Error("Parameter 1 must be of type Array");if("undefined"!==typeof c){if("object"!==typeof c)throw Error("Parameter 2 must be of type object");
}else c={};window.addEventListener("resize",function(){ContextUtil.getProperty(c,"close_on_resize",!0)&&d.hide()});this.setOptions=function(b){if("object"===typeof b)c=b;else throw Error("Parameter 1 must be of type object");};this.changeOption=function(b,n){if("string"===typeof b)if("undefined"!==typeof n)c[b]=n;else throw Error("Parameter 2 must be set");else throw Error("Parameter 1 must be of type string");};this.getOptions=function(){return c};this.reload=function(){if(null==document.getElementById("cm_"+
m)){var b=document.createElement("div");b.className="cm_container";b.id="cm_"+m;document.body.appendChild(b)}b=document.getElementById("cm_"+m);b.innerHTML="";b.appendChild(k(g))};this.display=function(b,n){d.contextTarget="undefined"!==typeof n?n:b.target;var a=document.getElementById("cm_"+m),f=b.clientX,h=b.clientY,e=a.offsetWidth+4,p=a.offsetHeight+4,q=window.innerWidth,r=window.innerHeight,t=parseInt(ContextUtil.getProperty(c,"mouse_offset",2));a.style.left=q-f<e?q-e+"px":f+t+"px";a.style.top=
r-h<p?r-p+"px":h+t+"px";e=ContextUtil.getSizes(a);q-f<e.width?a.classList.add("cm_border_right"):a.classList.remove("cm_border_right");r-h<e.height?a.classList.add("cm_border_bottom"):a.classList.remove("cm_border_bottom");a.classList.add("display");ContextUtil.getProperty(c,"close_on_click",!0)&&window.addEventListener("click",l);b.preventDefault()};this.hide=function(){document.getElementById("cm_"+m)&&(document.getElementById("cm_"+m).classList.remove("display"),window.removeEventListener("click",
l))};this.reload()}ContextMenu.count=0;ContextMenu.DIVIDER="cm_divider";
var ContextUtil={getProperty:function(g,c,k){return"undefined"!==typeof g[c]?g[c]:k},getSizes:function(g){g=g.getElementsByTagName("li");for(var c=0,k=0,l=0;l<g.length;l++){var d=g[l];d.offsetWidth>c&&(c=d.offsetWidth);d.offsetHeight>k&&(k=d.offsetHeight)}var m=c,b=k;for(l=0;l<g.length;l++)d=g[l],d=d.getElementsByTagName("ul"),"undefined"!==typeof d[0]&&(d=ContextUtil.getSizes(d[0]),c+d.width>m&&(m=c+d.width),k+d.height>b&&(b=k+d.height));return{width:m,height:b}}};
